$(document).ready(function(){var b=[{path:"/login",templates:["login.html"],title:"Login"},{path:"/logout",templates:["logout.html"],title:"Logging out ..."},{path:"/",templates:["header.html","posts.html","footer.html"],before:function(d,c){if(c.page==1){window.open(theme.host+theme.rootPath+theme.sitePath);return false}},title:"{{{header_html.title}}} / Admin"},{path:"/meta",templates:["header.html","meta.html","footer.html"],title:"{{{header_html.title}}} / Admin - Meta"},{path:/^\/posts\/.+$/,templates:["header.html","post.html","footer.html"],title:"{{{header_html.title}}} / Admin - {{{post_html.title}}}"},{path:"/create/post",templates:["header.html","create-post.html","footer.html"],title:"{{{header_html.title}}} / Admin - Create Post"}];function a(e,d){var c={};c["login.html"]={data:d};c["header.html"]={load:function(f){e.read("meta",function(g,h){if(h){f(null,{title:h.message,heading:"HTTP Error",message:"The error <code>"+h.code+" "+h.message+"</code> occured."})}else{f(g)}})}};c["footer.html"]={load:function(f){e.read("meta",function(g,h){if(h){f(null,{title:h.message,heading:"HTTP Error",message:"The error <code>"+h.code+" "+h.message+"</code> occured."})}else{f(g)}})}};c["posts.html"]={load:function(l,j,i){var g=10,h=parseInt(i.page||1),f=h-1;skip=g*f;e.view("posts","byDate?descending=true&skip="+skip+"&limit="+g,function(m,n){if(n){l(null,{title:n.message,heading:"HTTP Error",message:"The error <code>"+n.code+" "+n.message+"</code> occured while loading the posts."})}else{var p=[];var q=m.rows;for(var o=q.length;o--;){p[o]=q[o].value}e.view("posts","compactByDate?descending=true&skip="+(skip+g)+"&limit=1",function(r,s){if(s){l(null,{title:s.message,heading:"HTTP Error",message:"The error <code>"+s.code+" "+s.message+"</code> occured."})}else{l(new k(f,{posts:p,hasNext:r.rows.length?true:false}))}})}});function k(m,n){this.previousPage=function(){if(m==0){return false}else{return{number:h-1}}};this.nextPage=function(){if(n.hasNext){return{number:h+1}}else{return false}};this.posts=n.posts}}};c["post.html"]={load:function(h,g){var f=g.replace(/^\/posts\//,"");e.view("posts",'byPostID?key="'+f+'"',function(i,j){if(j){h(null,{title:j.message,heading:"HTTP Error",message:"The error <code>"+j.code+" "+j.message+"</code> occured while loading the post."})}else{if(!i.rows.length){h(null,{title:"Not Found",heading:"Post not found",message:"The post you were looking for wasn't found."})}else{h(i.rows[0].value)}}})}};c["meta.html"]={load:function(f){e.read("meta",function(g,h){if(h){f(null,{title:h.message,heading:"HTTP Error",message:"The error <code>"+h.code+" "+h.message+"</code> occured while loading meta."})}else{f(g)}})}};return c}$.ajax({url:"_root/config.json",dataType:"json",error:function(c,e,d){fatalError("Ajax Error","Error <code>"+e+" "+d+"</code> occured while loading <code>"+this.url+"</code>.")},success:function(c){var d=new (new CouchDB(c.root+"/couchdb")).Database(c.database);window.createTheme({rootPath:c.root,sitePath:"/admin",filePath:"/etc/admin/theme",routes:b,views:a(d,c)})}})});