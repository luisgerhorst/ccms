var CouchDB=function(b){$.ajaxSetup({timeout:15000});var d=this;var c=function(f){f=f?f:{};this.cookie=f.cookie?true:false;this.username=typeof f.username==="string"?f.username:false;this.password=typeof f.password==="string"?f.password:false};var a=new c(null);function e(g){var f=g.status;if(f!=200&&f!=201){return{code:f,message:g.statusText,jqXHR:g}}else{return false}}d.authorize=function(f){a=new c(f);return d};d.deauthorize=function(){a=new c(null);return d};d.remember=function(f){if(a.username&&a.password){$.ajax({url:b+"/_session/",type:"POST",data:"name="+encodeURIComponent(a.username)+"&password="+encodeURIComponent(a.password),contentType:"application/x-www-form-urlencoded",error:function(g,h){console.log('Error "'+h+'" occured while '+options.type+" request to "+options.url,g);if(f){f(e(g))}},success:function(){console.log("db-remember-success");a.cookie=true;if(f){f(false)}}})}return d};d.forget=function(f){$.ajax({url:b+"/_session/",type:"DELETE",error:function(g,h){console.log('Error "'+h+'" occured while '+options.type+" request to "+options.url,g);if(f){f(e(g))}},success:function(){a.cookie=false;if(f){f(false)}}});return d};d.Database=function(i){var h=this;function f(l,j){var k=l.document?l.document:"";this.type=l.type||"GET";this.url=b+"/"+i+"/"+k;this.data=JSON.stringify(l.data)||undefined;this.contentType=this.data?"application/json":undefined;if(!a.cookie&&a.username&&a.password&&this.type!=="HEAD"&&this.type!=="GET"){this.headers={Authorization:"Basic "+btoa(a.username+":"+a.password)}}this.success=function(n,o,m){j(n,m)};this.error=function(m,o,n){j(null,m)}}function g(k,j){$.ajax(new f(k,j))}h.read=function(j,k){g({document:j},function(m,l){k(JSON.parse(m),e(l))});return h};h.exists=function(j,k){g({document:j,type:"HEAD"},function(m,l){if(l.status===200){k(l.getResponseHeader("Etag").replace(/"/g,""),e(l))}else{k(false,e(l))}});return h};h.view=function(k,j,l){g({document:"_design/"+k+"/_view/"+j},function(n,m){l(JSON.parse(n),e(m))});return h};h.save=function(m,l,j){var n=function(){var o=m,p=l,q=j;g({document:o,type:"HEAD"},function(t,s){var r=s.status;p._rev=r==200?s.getResponseHeader("Etag").replace(/"/g,""):undefined;if(r==404||r==200){g({document:o,type:"PUT",data:p},function(v,u){q(JSON.parse(v),e(u))})}else{q(null,e(s))}})};var k=function(){var o=m,p=l;g({type:"POST",data:o},function(r,q){p(JSON.parse(r),e(q))})};if(typeof m==="string"){n()}else{k()}return h};h.remove=function(j,k){g({document:j,type:"HEAD"},function(m,l){if(l.status==200){g({document:j+"?rev="+l.getResponseHeader("Etag").replace(/"/g,""),type:"DELETE"},function(o,n){k(JSON.parse(o),e(n))})}else{k(null,e(l))}});return h}};d.createDatabase=function(g,h){var f={url:b+"/"+g+"/",type:"PUT",error:function(i,k,j){h(null,e(i))},success:function(j,k,i){h(new d.Database(g),false)}};if(!a.cookie&&a.username&&a.password){f.headers={Authorization:"Basic "+btoa(a.username+":"+a.password)}}$.ajax(f);return d};d.deleteDatabase=function(g,h){var f={url:b+"/"+g+"/",type:"DELETE",error:function(i,k,j){console.log('Error "'+k+'" occured while '+this.type+" request to "+this.url,i);h(e(i))},success:function(j,k,i){h(false)}};if(!a.cookie&&a.username&&a.password){f.headers={Authorization:"Basic "+btoa(a.username+":"+a.password)}}$.ajax(f);return d};d.getAdmins=function(g){var f={url:b+"/_config/admins/",type:"GET",error:function(h,j,i){g(null,e(h))},success:function(i,j,h){g(i,false)}};if(!a.cookie&&a.username&&a.password){f.headers={Authorization:"Basic "+btoa(a.username+":"+a.password)}}$.ajax(f);return d};d.createAdmin=function(h,g,i){var f={url:b+"/_config/admins/"+h,type:"PUT",data:'"'+g+'"',error:function(j,l,k){console.log('Error "'+l+'" occured while '+this.type+" request to "+this.url,j);i(e(j))},success:function(k,l,j){i(false)}};if(!a.cookie&&a.username&&a.password){f.headers={Authorization:"Basic "+btoa(a.username+":"+a.password)}}$.ajax(f);return d};d.deleteAdmin=function(g,h){var f={url:b+"/_config/admins/"+g,type:"DELETE",error:function(i,k,j){console.log('Error "'+k+'" occured while '+this.type+" request to "+this.url,i);h(e(i))},success:function(j,k,i){h(false)}};if(!a.cookie&&a.username&&a.password){f.headers={Authorization:"Basic "+btoa(a.username+":"+a.password)}}$.ajax(f);return d}};